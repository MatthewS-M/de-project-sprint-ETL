![image](https://github.com/MatthewS-M/de-project-sprint-3/assets/117388645/095c0b83-e9ae-4c02-8739-096e3417847d)

## Описание работы
Был создан пайплайн выгрузки файлов из API в базу данных согласно инструкции в техзадании. Реализовано добавление каждого нового инкремента в базу. 
Были созданы две результирующие витрины: `mart.f_customer_retention` и `mart.retention_compact`. 
Первая отображает все перечисленные в задании атрибуты, только в качестве `item_id` были добавлены id товаров по каждой категории клиентов (новые, вернувшиеся, сделавшие возврат). 
Вторая таблица является более компактным отображением с агрегатными столбцами по сумме выплат и количеству клиентов по каждой категории и по каждому периоду времени.
Период времени - _неделя_. В результате было выделено 5 недель. В новых данных (инкрементированных) имеются значения только по 4 и 5 неделе, поэтому в остальных они записываются, как `NULL`.

_Компактная таблица:_
![image](https://github.com/MatthewS-M/de-project-sprint-3/assets/117388645/2de9a1ce-a23c-48b9-81a4-c6cfee687e51)

_Срез из полной таблицы:_
![image](https://github.com/MatthewS-M/de-project-sprint-3/assets/117388645/3157e2e3-a3f0-4a44-8d02-1bf719759922)



Результаты отладки пайплайна в AirFlow.
![image](https://github.com/MatthewS-M/de-project-sprint-3/assets/117388645/8c397a30-fe15-464e-b171-cc7a3b983376)
![image](https://github.com/MatthewS-M/de-project-sprint-3/assets/117388645/75a6477b-594b-4082-8df7-09bdb0f68e11)


В дальнейшем будет производиться оптимизация пайплайна для уменьшения строчек кода.

___

## Работа над ошибками
1. Не совсем понял комментарий: "Да, определённо стоит вынести из этих функций абсолютно идентичный код в другую, чтобы вызывать её". Это сарказм?) Я просто разбивал на подзадачи, чтобы отлаживать пайплайн, а то в одном все смешалось. Сейчас объединил все в одну задачу, но что-то пока не знаю, как оптимизировать (упростить вид), если только создать функцию внутри задачи, в которую передавать название каждого файла и также циклом прогонять. Надо найти способ попроще.
