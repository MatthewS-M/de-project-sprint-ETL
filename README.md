# ETL и автоматизация подготовки данных

Передо мной была посталена задача организовать ETL-процесс, чтобы он соответствовали новым задачам бизнеса. Краткое описание ТЗ:

Необходимо сконструировать пайплайн для новой функциональности отмены заказов и возврата средств.

### Обновление пайплайна:
Добавьте новый этап в пайплайн, который будет обрабатывать данные с новым статусом заказа refunded.
Учтите этот статус при обработке данных и обновлении витрин. Убедитесь, что ваш код корректно обрабатывает данные с новым статусом и не дублирует их.

### Обновление витрин:
- В витрине mart.f_sales добавьте колонку со статусом refunded и соответствующим значением.
- Обновите формулы для расчета метрик, учитывая статус refunded.

### Исследование возвращаемости клиентов:
- Создайте новую витрину mart.f_customer_retention, как указано в задании.
- Наполните витрину данными по «возвращаемости клиентов» в разрезе недель.
- Рассчитайте нужные метрики и добавьте их в витрину.

### Перезапуск пайплайна:
- Перезапустите пайплайн с новым инкрементом.
- Проверьте, что данные корректно обрабатываются и не дублируются.

### Витрина customer retention:
- Наполните витрину mart.f_customer_retention данными по «возвращаемости клиентов».
- Рассчитайте нужные метрики и добавьте их в витрину.
